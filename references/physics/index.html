
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../data/">
      
      
        <link rel="next" href="../fitting/">
      
      
        
      
      
      <link rel="icon" href="../../logo/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34+insiders-4.53.12">
    
    
      
        <title>physics - XSB-fluctuations</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.52c0e027.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/material.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#xsb_fluc.physics.density" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="XSB-fluctuations" class="md-header__button md-logo" aria-label="XSB-fluctuations" data-md-component="logo">
      
  <img src="../../logo/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            XSB-fluctuations
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              physics
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://gitlab.in2p3.fr/simon.dupourque/fluctuation_xcop" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    xsb_fluctuation
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="XSB-fluctuations" class="md-nav__button md-logo" aria-label="XSB-fluctuations" data-md-component="logo">
      
  <img src="../../logo/logo.png" alt="logo">

    </a>
    XSB-fluctuations
  </label>
  
    <div class="md-nav__source">
      <a href="https://gitlab.in2p3.fr/simon.dupourque/fluctuation_xcop" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    xsb_fluctuation
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/open_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Load data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/compute_nh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    $N_H$ computation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/voronoi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Voronoi tesselation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/mean_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    SB model fitting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/power_spectrum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Computing the power spectrum
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/sbi_with_spectra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Simulate spectra
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    API reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    API reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    
  
    physics
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    
  
    physics
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#xsb_fluc.physics.density" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;density
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" density">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.density.BetaModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BetaModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BetaModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.density.BetaModel.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.density.CleanVikhlininModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CleanVikhlininModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" CleanVikhlininModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.density.CleanVikhlininModel.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xsb_fluc.physics.temperature" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;temperature
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" temperature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.temperature.GhirardiniModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;GhirardiniModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" GhirardiniModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.temperature.GhirardiniModel.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xsb_fluc.physics.cooling" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;cooling
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" cooling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.cooling.CoolingFunctionGrid" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CoolingFunctionGrid
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" CoolingFunctionGrid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.cooling.CoolingFunctionGrid.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.cooling.CoolingFunctionModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CoolingFunctionModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xsb_fluc.physics.emissivity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;emissivity
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" emissivity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.emissivity.XrayEmissivity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;XrayEmissivity
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" XrayEmissivity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.emissivity.XrayEmissivity.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.emissivity.XrayEmissivity.from_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_data
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xsb_fluc.physics.projection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;projection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" projection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.projection.AbelTransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AbelTransform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" AbelTransform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.projection.AbelTransform.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xsb_fluc.physics.surface_brightness" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;surface_brightness
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" surface_brightness">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.surface_brightness.XraySurfaceBrightness" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;XraySurfaceBrightness
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" XraySurfaceBrightness">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.surface_brightness.XraySurfaceBrightness.from_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_data
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.surface_brightness.XraySurfaceBrightnessBetaModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;XraySurfaceBrightnessBetaModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xsb_fluc.physics.ellipse" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;ellipse
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ellipse">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.ellipse.EllipseRadius" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;EllipseRadius
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" EllipseRadius">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.ellipse.EllipseRadius.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.ellipse.EllipseRadius.from_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_data
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xsb_fluc.physics.turbulence" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;turbulence
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" turbulence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.turbulence.KolmogorovPowerSpectrum" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;KolmogorovPowerSpectrum
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fitting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    fitting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../simulation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    simulation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#xsb_fluc.physics.density" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;density
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" density">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.density.BetaModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;BetaModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" BetaModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.density.BetaModel.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.density.CleanVikhlininModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CleanVikhlininModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" CleanVikhlininModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.density.CleanVikhlininModel.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xsb_fluc.physics.temperature" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;temperature
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" temperature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.temperature.GhirardiniModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;GhirardiniModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" GhirardiniModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.temperature.GhirardiniModel.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xsb_fluc.physics.cooling" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;cooling
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" cooling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.cooling.CoolingFunctionGrid" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CoolingFunctionGrid
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" CoolingFunctionGrid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.cooling.CoolingFunctionGrid.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.cooling.CoolingFunctionModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;CoolingFunctionModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xsb_fluc.physics.emissivity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;emissivity
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" emissivity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.emissivity.XrayEmissivity" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;XrayEmissivity
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" XrayEmissivity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.emissivity.XrayEmissivity.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.emissivity.XrayEmissivity.from_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_data
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xsb_fluc.physics.projection" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;projection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" projection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.projection.AbelTransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;AbelTransform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" AbelTransform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.projection.AbelTransform.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xsb_fluc.physics.surface_brightness" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;surface_brightness
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" surface_brightness">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.surface_brightness.XraySurfaceBrightness" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;XraySurfaceBrightness
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" XraySurfaceBrightness">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.surface_brightness.XraySurfaceBrightness.from_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_data
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.surface_brightness.XraySurfaceBrightnessBetaModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;XraySurfaceBrightnessBetaModel
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xsb_fluc.physics.ellipse" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;ellipse
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ellipse">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.ellipse.EllipseRadius" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;EllipseRadius
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" EllipseRadius">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.ellipse.EllipseRadius.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.ellipse.EllipseRadius.from_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_data
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xsb_fluc.physics.turbulence" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;turbulence
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" turbulence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xsb_fluc.physics.turbulence.KolmogorovPowerSpectrum" class="md-nav__link">
    <span class="md-ellipsis">
      
        <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;KolmogorovPowerSpectrum
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>physics</h1>

<div class="doc doc-object doc-module">



<h3 id="xsb_fluc.physics.density" class="doc doc-heading">
            <code>xsb_fluc.physics.density</code>


<a href="#xsb_fluc.physics.density" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents first">

        <p>Python module containing models for the density profile of the ICM.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="xsb_fluc.physics.density.BetaModel" class="doc doc-heading">
            <code>BetaModel</code>


<a href="#xsb_fluc.physics.density.BetaModel" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Module</code></p>



        <p>Density model which use a beta-model formula</p>
<div class="arithmatex">\[n_{e}^2(r) = n_{e,0}^2 \left( 1 + \left( \frac{r}{r_{c}} \right)^{2} \right)^{-3\beta}\]</div>






              <details class="quote">
                <summary>Source code in <code>src/xsb_fluc/physics/density.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BetaModel</span><span class="p">(</span><span class="n">hk</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Density model which use a beta-model formula</span>

<span class="sd">    $$n_{e}^2(r) = n_{e,0}^2 \left( 1 + \left( \frac{r}{r_{c}} \right)^{2} \right)^{-3\beta}$$</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">BetaModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the density function for a given radius.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            r (jnp.array): Radius to compute the density function in R500 units</span>

<span class="sd">        Returns:</span>
<span class="sd">            (jnp.array): Density function evaluated at the given radius in cm$^{-6}$</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">log_ne2</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;log_ne2&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mf">3.</span><span class="p">))</span>
        <span class="n">log_r_c</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;log_r_c&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>

        <span class="n">ne2</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">log_ne2</span>
        <span class="n">r_c</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">log_r_c</span>

        <span class="n">term1</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">r_c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="n">beta</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ne2</span> <span class="o">*</span> <span class="n">term1</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="xsb_fluc.physics.density.BetaModel.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">r</span><span class="p">)</span></code>

<a href="#xsb_fluc.physics.density.BetaModel.__call__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Compute the density function for a given radius.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>r</code>
            </td>
            <td>
                  <code>array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Radius to compute the density function in R500 units</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Density function evaluated at the given radius in cm<span class="arithmatex">\(^{-6}\)</span></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/xsb_fluc/physics/density.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the density function for a given radius.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        r (jnp.array): Radius to compute the density function in R500 units</span>

<span class="sd">    Returns:</span>
<span class="sd">        (jnp.array): Density function evaluated at the given radius in cm$^{-6}$</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">log_ne2</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;log_ne2&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mf">3.</span><span class="p">))</span>
    <span class="n">log_r_c</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;log_r_c&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>

    <span class="n">ne2</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">log_ne2</span>
    <span class="n">r_c</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">log_r_c</span>

    <span class="n">term1</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">r_c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="n">beta</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ne2</span> <span class="o">*</span> <span class="n">term1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="xsb_fluc.physics.density.CleanVikhlininModel" class="doc doc-heading">
            <code>CleanVikhlininModel</code>


<a href="#xsb_fluc.physics.density.CleanVikhlininModel" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Module</code></p>



        <p>Density model which use a modified Vikhlinin functional form, with alpha fixed to 0 and gamma to 3</p>
<div class="arithmatex">\[n_{e}^2(r) = n_{e,0}^2 \left( 1 + \left( \frac{r}{r_{c}} \right)^{2} \right)^{-3\beta} \left(1+\left( \frac{r}{r_{c}} \right)^{\gamma} \right)^{-\frac{\epsilon}{\gamma}}\]</div>






              <details class="quote">
                <summary>Source code in <code>src/xsb_fluc/physics/density.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CleanVikhlininModel</span><span class="p">(</span><span class="n">hk</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Density model which use a modified Vikhlinin functional form, with alpha fixed to 0 and gamma to 3</span>

<span class="sd">    $$n_{e}^2(r) = n_{e,0}^2 \left( 1 + \left( \frac{r}{r_{c}} \right)^{2} \right)^{-3\beta} \left(1+\left( \frac{r}{r_{c}} \right)^{\gamma} \right)^{-\frac{\epsilon}{\gamma}}$$</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CleanVikhlininModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the density function for a given radius.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            r (jnp.array): Radius to compute the density function in R500 units</span>

<span class="sd">        Returns:</span>
<span class="sd">            (jnp.array): Density function evaluated at the given radius in cm$^{-6}$</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">log_ne2</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;log_ne2&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mf">3.</span><span class="p">))</span>
        <span class="n">log_r_c</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;log_r_c&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">))</span>
        <span class="n">log_r_s</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;log_r_s&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">))</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mf">0.6</span><span class="p">))</span>
        <span class="n">epsilon</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;epsilon&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mf">3.</span><span class="p">))</span>

        <span class="n">gamma</span> <span class="o">=</span> <span class="mf">3.</span>

        <span class="n">ne2</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">log_ne2</span>
        <span class="n">r_c</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">log_r_c</span>
        <span class="n">r_s</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">log_r_s</span>

        <span class="n">term1</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">r_c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="n">beta</span><span class="p">)</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">r_s</span><span class="p">)</span> <span class="o">**</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">epsilon</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ne2</span> <span class="o">*</span> <span class="n">term1</span> <span class="o">*</span> <span class="n">term2</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="xsb_fluc.physics.density.CleanVikhlininModel.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">r</span><span class="p">)</span></code>

<a href="#xsb_fluc.physics.density.CleanVikhlininModel.__call__" class="headerlink" title="Permanent link">&para;</a></h5>


    <div class="doc doc-contents ">

        <p>Compute the density function for a given radius.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>r</code>
            </td>
            <td>
                  <code>array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Radius to compute the density function in R500 units</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Density function evaluated at the given radius in cm<span class="arithmatex">\(^{-6}\)</span></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/xsb_fluc/physics/density.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the density function for a given radius.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        r (jnp.array): Radius to compute the density function in R500 units</span>

<span class="sd">    Returns:</span>
<span class="sd">        (jnp.array): Density function evaluated at the given radius in cm$^{-6}$</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">log_ne2</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;log_ne2&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mf">3.</span><span class="p">))</span>
    <span class="n">log_r_c</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;log_r_c&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">))</span>
    <span class="n">log_r_s</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;log_r_s&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">))</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mf">0.6</span><span class="p">))</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;epsilon&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mf">3.</span><span class="p">))</span>

    <span class="n">gamma</span> <span class="o">=</span> <span class="mf">3.</span>

    <span class="n">ne2</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">log_ne2</span>
    <span class="n">r_c</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">log_r_c</span>
    <span class="n">r_s</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">log_r_s</span>

    <span class="n">term1</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">r_c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="n">beta</span><span class="p">)</span>
    <span class="n">term2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">r_s</span><span class="p">)</span> <span class="o">**</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">epsilon</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ne2</span> <span class="o">*</span> <span class="n">term1</span> <span class="o">*</span> <span class="n">term2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="xsb_fluc.physics.temperature" class="doc doc-heading">
            <code>xsb_fluc.physics.temperature</code>


<a href="#xsb_fluc.physics.temperature" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Python module containing models for the temperature profile of the ICM.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="xsb_fluc.physics.temperature.GhirardiniModel" class="doc doc-heading">
            <code>GhirardiniModel</code>


<a href="#xsb_fluc.physics.temperature.GhirardiniModel" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Module</code></p>



        <p>Universal temperature profile as defined in Ghirardini 2018+ in the X-COP cluster sample</p>






              <details class="quote">
                <summary>Source code in <code>src/xsb_fluc/physics/temperature.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GhirardiniModel</span><span class="p">(</span><span class="n">hk</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Universal temperature profile as defined in Ghirardini 2018+ in the X-COP cluster sample</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GhirardiniModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the temperature function for a given radius.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            r (jnp.array): Radius to compute the temperature in $R_{500}$ units</span>

<span class="sd">        Returns:</span>
<span class="sd">            (jnp.array): Temperature function evaluated at the given radius in keV</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">T0</span> <span class="o">=</span> <span class="mf">1.21</span>
        <span class="n">rcool</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.78</span><span class="p">)</span>
        <span class="n">rt</span> <span class="o">=</span> <span class="mf">0.34</span>
        <span class="n">TmT0</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">acool</span> <span class="o">=</span> <span class="mf">1.03</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="mf">0.27</span>

        <span class="n">T500</span> <span class="o">=</span> <span class="mf">7.</span>  <span class="c1"># keV</span>

        <span class="n">term1</span> <span class="o">=</span> <span class="p">(</span><span class="n">TmT0</span> <span class="o">+</span> <span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">rcool</span><span class="p">)</span> <span class="o">**</span> <span class="n">acool</span><span class="p">)</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">rcool</span><span class="p">)</span> <span class="o">**</span> <span class="n">acool</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">rt</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="n">c2</span>

        <span class="k">return</span> <span class="n">T500</span> <span class="o">*</span> <span class="n">T0</span> <span class="o">*</span> <span class="n">term1</span> <span class="o">/</span> <span class="n">term2</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="xsb_fluc.physics.temperature.GhirardiniModel.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">r</span><span class="p">)</span></code>

<a href="#xsb_fluc.physics.temperature.GhirardiniModel.__call__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Compute the temperature function for a given radius.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>r</code>
            </td>
            <td>
                  <code>array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Radius to compute the temperature in <span class="arithmatex">\(R_{500}\)</span> units</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temperature function evaluated at the given radius in keV</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/xsb_fluc/physics/temperature.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the temperature function for a given radius.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        r (jnp.array): Radius to compute the temperature in $R_{500}$ units</span>

<span class="sd">    Returns:</span>
<span class="sd">        (jnp.array): Temperature function evaluated at the given radius in keV</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">T0</span> <span class="o">=</span> <span class="mf">1.21</span>
    <span class="n">rcool</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.78</span><span class="p">)</span>
    <span class="n">rt</span> <span class="o">=</span> <span class="mf">0.34</span>
    <span class="n">TmT0</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">acool</span> <span class="o">=</span> <span class="mf">1.03</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="mf">0.27</span>

    <span class="n">T500</span> <span class="o">=</span> <span class="mf">7.</span>  <span class="c1"># keV</span>

    <span class="n">term1</span> <span class="o">=</span> <span class="p">(</span><span class="n">TmT0</span> <span class="o">+</span> <span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">rcool</span><span class="p">)</span> <span class="o">**</span> <span class="n">acool</span><span class="p">)</span>
    <span class="n">term2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">rcool</span><span class="p">)</span> <span class="o">**</span> <span class="n">acool</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="n">rt</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="n">c2</span>

    <span class="k">return</span> <span class="n">T500</span> <span class="o">*</span> <span class="n">T0</span> <span class="o">*</span> <span class="n">term1</span> <span class="o">/</span> <span class="n">term2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="xsb_fluc.physics.cooling" class="doc doc-heading">
            <code>xsb_fluc.physics.cooling</code>


<a href="#xsb_fluc.physics.cooling" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Python module containing structures to compute the cooling function approximation for the ICM.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="xsb_fluc.physics.cooling.CoolingFunctionGrid" class="doc doc-heading">
            <code>CoolingFunctionGrid</code>


<a href="#xsb_fluc.physics.cooling.CoolingFunctionGrid" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">








              <details class="quote">
                <summary>Source code in <code>src/xsb_fluc/physics/cooling.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CoolingFunctionGrid</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">redshift</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">kT_span</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">),</span> <span class="n">nH_span</span><span class="o">=</span><span class="p">(</span><span class="mf">9e19</span><span class="p">,</span> <span class="mf">2e21</span><span class="p">)):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Awfully coded class to compute the cooling function grid for a given redshift.</span>
<span class="sd">        The grid is saved in a .npy file in the results folder. XSPEC is not needed if the</span>
<span class="sd">        grid is already computed. Else it will be computed using XSPEC.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">redshift</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">redshift</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span> <span class="o">=</span> <span class="n">n_points</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kT_span</span> <span class="o">=</span> <span class="n">kT_span</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nH_span</span> <span class="o">=</span> <span class="n">nH_span</span>

        <span class="n">pars</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">redshift</span><span class="p">,</span> <span class="n">n_points</span><span class="p">,</span> <span class="o">*</span><span class="n">kT_span</span><span class="p">,</span> <span class="o">*</span><span class="n">nH_span</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">kT_span</span><span class="p">,</span> <span class="n">n_points</span><span class="p">),</span>
                                       <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="o">*</span><span class="n">nH_span</span><span class="p">,</span> <span class="n">n_points</span><span class="p">),</span>
                                       <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>

        <span class="n">cooling_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">RESULTS_PATH</span><span class="p">,</span> <span class="s1">&#39;cooling_database&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pars</span><span class="si">}</span><span class="s1">.npy&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">cooling_path</span><span class="p">):</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cooling grid not found! Computing with XSPEC&#39;</span><span class="p">)</span>

            <span class="kn">from</span> <span class="nn">.countrate</span> <span class="kn">import</span> <span class="n">PHabsAPEC</span>

            <span class="n">phabs</span> <span class="o">=</span> <span class="n">PHabsAPEC</span><span class="p">()</span>

            <span class="n">abundance</span> <span class="o">=</span> <span class="mf">0.3</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="mf">1.</span>
            <span class="n">countrate</span> <span class="o">=</span> <span class="n">phabs</span><span class="o">.</span><span class="n">countrate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nH</span> <span class="o">/</span> <span class="mf">1e22</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kT</span><span class="p">,</span> <span class="n">abundance</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">redshift</span><span class="p">),</span> <span class="n">norm</span><span class="p">)</span>

            <span class="c1"># XSPEC norm factor for an apec model</span>
            <span class="n">dc</span> <span class="o">=</span> <span class="n">FlatLambdaCDM</span><span class="p">(</span><span class="mi">70</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span><span class="o">.</span><span class="n">comoving_distance</span><span class="p">(</span><span class="n">redshift</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="p">)</span>
            <span class="n">factor</span> <span class="o">=</span> <span class="mf">1e-14</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">dc</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.17</span>

            <span class="c1"># Units of the countrate over units of the norm of APEC model</span>
            <span class="n">cooling</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">countrate</span> <span class="o">*</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">count</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="o">**</span> <span class="mi">5</span><span class="p">)</span>

            <span class="c1"># Conversion to the best unit for Lambda * ne^2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cooling</span> <span class="o">=</span> <span class="p">(</span><span class="n">cooling</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">count</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="o">**</span> <span class="mi">6</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">kpc</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">))</span><span class="o">.</span><span class="n">value</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">cooling_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cooling</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">cooling</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">cooling_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="xsb_fluc.physics.cooling.CoolingFunctionGrid.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">redshift</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">kT_span</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span> <span class="n">nH_span</span><span class="o">=</span><span class="p">(</span><span class="mf">9e+19</span><span class="p">,</span> <span class="mf">2e+21</span><span class="p">))</span></code>

<a href="#xsb_fluc.physics.cooling.CoolingFunctionGrid.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Awfully coded class to compute the cooling function grid for a given redshift.
The grid is saved in a .npy file in the results folder. XSPEC is not needed if the
grid is already computed. Else it will be computed using XSPEC.</p>

            <details class="quote">
              <summary>Source code in <code>src/xsb_fluc/physics/cooling.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">redshift</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">kT_span</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">),</span> <span class="n">nH_span</span><span class="o">=</span><span class="p">(</span><span class="mf">9e19</span><span class="p">,</span> <span class="mf">2e21</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Awfully coded class to compute the cooling function grid for a given redshift.</span>
<span class="sd">    The grid is saved in a .npy file in the results folder. XSPEC is not needed if the</span>
<span class="sd">    grid is already computed. Else it will be computed using XSPEC.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">redshift</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">redshift</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span> <span class="o">=</span> <span class="n">n_points</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kT_span</span> <span class="o">=</span> <span class="n">kT_span</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nH_span</span> <span class="o">=</span> <span class="n">nH_span</span>

    <span class="n">pars</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">redshift</span><span class="p">,</span> <span class="n">n_points</span><span class="p">,</span> <span class="o">*</span><span class="n">kT_span</span><span class="p">,</span> <span class="o">*</span><span class="n">nH_span</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">kT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">kT_span</span><span class="p">,</span> <span class="n">n_points</span><span class="p">),</span>
                                   <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="o">*</span><span class="n">nH_span</span><span class="p">,</span> <span class="n">n_points</span><span class="p">),</span>
                                   <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>

    <span class="n">cooling_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">RESULTS_PATH</span><span class="p">,</span> <span class="s1">&#39;cooling_database&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pars</span><span class="si">}</span><span class="s1">.npy&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">cooling_path</span><span class="p">):</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cooling grid not found! Computing with XSPEC&#39;</span><span class="p">)</span>

        <span class="kn">from</span> <span class="nn">.countrate</span> <span class="kn">import</span> <span class="n">PHabsAPEC</span>

        <span class="n">phabs</span> <span class="o">=</span> <span class="n">PHabsAPEC</span><span class="p">()</span>

        <span class="n">abundance</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">countrate</span> <span class="o">=</span> <span class="n">phabs</span><span class="o">.</span><span class="n">countrate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nH</span> <span class="o">/</span> <span class="mf">1e22</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kT</span><span class="p">,</span> <span class="n">abundance</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">redshift</span><span class="p">),</span> <span class="n">norm</span><span class="p">)</span>

        <span class="c1"># XSPEC norm factor for an apec model</span>
        <span class="n">dc</span> <span class="o">=</span> <span class="n">FlatLambdaCDM</span><span class="p">(</span><span class="mi">70</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span><span class="o">.</span><span class="n">comoving_distance</span><span class="p">(</span><span class="n">redshift</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="p">)</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="mf">1e-14</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">dc</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.17</span>

        <span class="c1"># Units of the countrate over units of the norm of APEC model</span>
        <span class="n">cooling</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">countrate</span> <span class="o">*</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">count</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="o">**</span> <span class="mi">5</span><span class="p">)</span>

        <span class="c1"># Conversion to the best unit for Lambda * ne^2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cooling</span> <span class="o">=</span> <span class="p">(</span><span class="n">cooling</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">count</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="o">**</span> <span class="mi">6</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">kpc</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">))</span><span class="o">.</span><span class="n">value</span>
        <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">cooling_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cooling</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cooling</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">cooling_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="xsb_fluc.physics.cooling.CoolingFunctionModel" class="doc doc-heading">
            <code>CoolingFunctionModel</code>


<a href="#xsb_fluc.physics.cooling.CoolingFunctionModel" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Module</code></p>



        <p>Cooling function model using a grid of precomputed cooling function. It is fitted to the grid using
a least square method on the fly. The model is given by the following formula:</p>
<div class="arithmatex">\[\Psi(N_H, T) \simeq \Lambda_0 e^{- N_H \sigma} \left( \frac{T}{T_{\text{break}}}\right)^{-\alpha_{1}}\left(\frac{1}{2} + \frac{1}{2}\left(\frac{T}{T_{\text{break}}}\right)^{1/\Delta}\right)^{(\alpha_1 - \alpha_2)\Delta}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><span class="arithmatex">\(\Psi(N_H, T)\)</span> here is different from <span class="arithmatex">\(\Lambda(T)\)</span> as it includes the instrumental convolution</p>
</div>






              <details class="quote">
                <summary>Source code in <code>src/xsb_fluc/physics/cooling.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CoolingFunctionModel</span><span class="p">(</span><span class="n">hk</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cooling function model using a grid of precomputed cooling function. It is fitted to the grid using</span>
<span class="sd">    a least square method on the fly. The model is given by the following formula:</span>

<span class="sd">    $$\Psi(N_H, T) \simeq \Lambda_0 e^{- N_H \sigma} \left( \frac{T}{T_{\text{break}}}\right)^{-\alpha_{1}}\left(\frac{1}{2} + \frac{1}{2}\left(\frac{T}{T_{\text{break}}}\right)^{1/\Delta}\right)^{(\alpha_1 - \alpha_2)\Delta}$$</span>

<span class="sd">    !!! note</span>
<span class="sd">        $\Psi(N_H, T)$ here is different from $\Lambda(T)$ as it includes the instrumental convolution</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coolingFunctionGrid</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CoolingFunctionModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="n">coolingFunctionGrid</span>
        <span class="c1"># Norm, sigma, kTbreak, alpha1, alpha2, delta</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">1.65</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fitness</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;BFGS&quot;</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">res</span><span class="o">.</span><span class="n">x</span>

    <span class="k">def</span> <span class="nf">kT_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kT</span><span class="p">,</span> <span class="n">kT_break</span><span class="p">,</span> <span class="n">alpha1</span><span class="p">,</span> <span class="n">alpha2</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">kT</span> <span class="o">/</span> <span class="n">kT_break</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">t</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">alpha1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">t</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">delta</span><span class="p">)))</span> <span class="o">**</span> <span class="p">((</span><span class="n">alpha1</span> <span class="o">-</span> <span class="n">alpha2</span><span class="p">)</span> <span class="o">*</span> <span class="n">delta</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">nH_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nH</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">nH</span> <span class="o">/</span> <span class="mf">1e22</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nH</span><span class="p">,</span> <span class="n">kT</span><span class="p">,</span> <span class="n">pars</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nH_dependency</span><span class="p">(</span><span class="n">nH</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">kT_dependency</span><span class="p">(</span><span class="n">kT</span><span class="p">,</span> <span class="o">*</span><span class="n">pars</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nH</span><span class="p">,</span> <span class="n">kT</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">nH</span><span class="p">,</span> <span class="n">kT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">fitness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pars</span><span class="p">):</span>
        <span class="n">lsq</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">cooling</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nH</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">kT</span><span class="p">,</span> <span class="n">pars</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>

        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lsq</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">cooling</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">residual</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lsq</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">cooling</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nH</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">kT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>

        <span class="k">return</span> <span class="n">lsq</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">cooling</span>

    <span class="k">def</span> <span class="nf">plot_residual</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">kT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nH</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">residual</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="xsb_fluc.physics.emissivity" class="doc doc-heading">
            <code>xsb_fluc.physics.emissivity</code>


<a href="#xsb_fluc.physics.emissivity" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="xsb_fluc.physics.emissivity.XrayEmissivity" class="doc doc-heading">
            <code>XrayEmissivity</code>


<a href="#xsb_fluc.physics.emissivity.XrayEmissivity" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Module</code></p>



        <p>3D Xray emissivity build with temperature, cooling function, density model.
It depends on the redshift of the cluster, since the cooling function is precomputed using XSPEC.
The default models are the ones used in the papers i.e. Vikhlinin for density, Ghirardini for temperature
and the interpolated cooling function.</p>






              <details class="quote">
                <summary>Source code in <code>src/xsb_fluc/physics/emissivity.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">XrayEmissivity</span><span class="p">(</span><span class="n">hk</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    3D Xray emissivity build with temperature, cooling function, density model.</span>
<span class="sd">    It depends on the redshift of the cluster, since the cooling function is precomputed using XSPEC.</span>
<span class="sd">    The default models are the ones used in the papers i.e. Vikhlinin for density, Ghirardini for temperature</span>
<span class="sd">    and the interpolated cooling function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">redshift</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">XrayEmissivity</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">squared_density</span> <span class="o">=</span> <span class="n">CleanVikhlininModel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="n">GhirardiniModel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cooling_function</span> <span class="o">=</span> <span class="n">CoolingFunctionModel</span><span class="p">(</span><span class="n">CoolingFunctionGrid</span><span class="p">(</span><span class="n">n_points</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">redshift</span><span class="o">=</span><span class="n">redshift</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_data</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="s2">&quot;Cluster&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create an emissivity model from a `Cluster` object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">nH</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the emissivity at a given radius, including $N_H$ absorption.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            r (jnp.array): radius in units of $R_{500}$</span>
<span class="sd">            nH (jnp.array): Hydrogen density in cm$^{-2}$ in the line of sight corresponding to the radius r</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cooling_function</span><span class="p">(</span><span class="n">nH</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">squared_density</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="xsb_fluc.physics.emissivity.XrayEmissivity.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">nH</span><span class="p">)</span></code>

<a href="#xsb_fluc.physics.emissivity.XrayEmissivity.__call__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Compute the emissivity at a given radius, including <span class="arithmatex">\(N_H\)</span> absorption.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>r</code>
            </td>
            <td>
                  <code>array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>radius in units of <span class="arithmatex">\(R_{500}\)</span></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nH</code>
            </td>
            <td>
                  <code>array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hydrogen density in cm<span class="arithmatex">\(^{-2}\)</span> in the line of sight corresponding to the radius r</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/xsb_fluc/physics/emissivity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">nH</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the emissivity at a given radius, including $N_H$ absorption.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        r (jnp.array): radius in units of $R_{500}$</span>
<span class="sd">        nH (jnp.array): Hydrogen density in cm$^{-2}$ in the line of sight corresponding to the radius r</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cooling_function</span><span class="p">(</span><span class="n">nH</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">squared_density</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="xsb_fluc.physics.emissivity.XrayEmissivity.from_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#xsb_fluc.physics.emissivity.XrayEmissivity.from_data" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Create an emissivity model from a <code>Cluster</code> object</p>

            <details class="quote">
              <summary>Source code in <code>src/xsb_fluc/physics/emissivity.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_data</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="s2">&quot;Cluster&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create an emissivity model from a `Cluster` object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="xsb_fluc.physics.projection" class="doc doc-heading">
            <code>xsb_fluc.physics.projection</code>


<a href="#xsb_fluc.physics.projection" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="xsb_fluc.physics.projection.AbelTransform" class="doc doc-heading">
            <code>AbelTransform</code>


<a href="#xsb_fluc.physics.projection.AbelTransform" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Module</code></p>



        <p>Projection tool for 3D models. Relies on double exponential quadrature.</p>
<div class="arithmatex">\[\text{AbelTransform}\left\{ f\right\}(x, y) =  \int \text{d}z \, f(x, y, z)\]</div>
<p>It uses double exponential quadrature to perform the integration.</p>
<p>References :</p>
<ul>
<li><a href="https://ems.press/journals/prims/articles/2686">Takahasi and Mori (1974)</a></li>
<li><a href="https://doi.org/10.1016/S0377-0427(00)00501-X">Mori and Sugihara (2001)</a></li>
<li><a href="https://en.wikipedia.org/wiki/Tanh-sinh_quadrature">Tanh-sinh quadrature</a> from wikipedia</li>
</ul>






              <details class="quote">
                <summary>Source code in <code>src/xsb_fluc/physics/projection.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AbelTransform</span><span class="p">(</span><span class="n">hk</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Projection tool for 3D models. Relies on double exponential quadrature.</span>

<span class="sd">    $$\text{AbelTransform}\left\{ f\right\}(x, y) =  \int \text{d}z \, f(x, y, z)$$</span>

<span class="sd">    It uses double exponential quadrature to perform the integration.</span>

<span class="sd">    References :</span>

<span class="sd">    * [Takahasi and Mori (1974)](https://ems.press/journals/prims/articles/2686)</span>
<span class="sd">    * [Mori and Sugihara (2001)](https://doi.org/10.1016/S0377-0427(00)00501-X)</span>
<span class="sd">    * [Tanh-sinh quadrature](https://en.wikipedia.org/wiki/Tanh-sinh_quadrature) from wikipedia</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span><span class="s2">&quot;hk.Module&quot;</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">71</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Take a model and project it along the line of sight.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            model (hk.Module): model to project</span>
<span class="sd">            n_points (int): number of points to use for the quadrature</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AbelTransform</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n_points</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>

        <span class="n">r</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">r</span><span class="p">)[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">phi</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">dphi</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">*</span> <span class="n">dx</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="xsb_fluc.physics.projection.AbelTransform.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">71</span><span class="p">)</span></code>

<a href="#xsb_fluc.physics.projection.AbelTransform.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Take a model and project it along the line of sight.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code>Module</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>model to project</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_points</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>number of points to use for the quadrature</p>
              </div>
            </td>
            <td>
                  <code>71</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/xsb_fluc/physics/projection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span><span class="s2">&quot;hk.Module&quot;</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">71</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Take a model and project it along the line of sight.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        model (hk.Module): model to project</span>
<span class="sd">        n_points (int): number of points to use for the quadrature</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">AbelTransform</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n_points</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="xsb_fluc.physics.surface_brightness" class="doc doc-heading">
            <code>xsb_fluc.physics.surface_brightness</code>


<a href="#xsb_fluc.physics.surface_brightness" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="xsb_fluc.physics.surface_brightness.XraySurfaceBrightness" class="doc doc-heading">
            <code>XraySurfaceBrightness</code>


<a href="#xsb_fluc.physics.surface_brightness.XraySurfaceBrightness" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Module</code></p>



        <p>Xray surface brightness model from 3D emissivity</p>






              <details class="quote">
                <summary>Source code in <code>src/xsb_fluc/physics/surface_brightness.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">XraySurfaceBrightness</span><span class="p">(</span><span class="n">hk</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Xray surface brightness model from 3D emissivity</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">redshift</span><span class="p">,</span> <span class="n">r_500</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">XraySurfaceBrightness</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">emissivity</span> <span class="o">=</span> <span class="n">XrayEmissivity</span><span class="p">(</span><span class="n">redshift</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surface_brightness</span> <span class="o">=</span> <span class="n">AbelTransform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">emissivity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_500</span> <span class="o">=</span> <span class="n">r_500</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">kpc</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_data</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="s2">&quot;Cluster&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a surface brightness model from a `Cluster` object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">r_500</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">nh</span><span class="p">):</span>
        <span class="n">log_bkg</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;log_bkg&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mf">5.</span><span class="p">))</span>

        <span class="c1"># As we integrate toward the l.o.s in r_500 units,</span>
        <span class="c1"># the surface brightness must be rescaled to be in good units</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface_brightness</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">nh</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_500</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">log_bkg</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="xsb_fluc.physics.surface_brightness.XraySurfaceBrightness.from_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#xsb_fluc.physics.surface_brightness.XraySurfaceBrightness.from_data" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Create a surface brightness model from a <code>Cluster</code> object</p>

            <details class="quote">
              <summary>Source code in <code>src/xsb_fluc/physics/surface_brightness.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_data</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="s2">&quot;Cluster&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a surface brightness model from a `Cluster` object</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">r_500</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="xsb_fluc.physics.surface_brightness.XraySurfaceBrightnessBetaModel" class="doc doc-heading">
            <code>XraySurfaceBrightnessBetaModel</code>


<a href="#xsb_fluc.physics.surface_brightness.XraySurfaceBrightnessBetaModel" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Module</code></p>



        <p>Xray surface brightness from a 2D surface brightness Beta-model</p>






              <details class="quote">
                <summary>Source code in <code>src/xsb_fluc/physics/surface_brightness.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">XraySurfaceBrightnessBetaModel</span><span class="p">(</span><span class="n">hk</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Xray surface brightness from a 2D surface brightness Beta-model</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="n">log_bkg</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;log_bkg&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mf">5.</span><span class="p">))</span>
        <span class="n">log_e_0</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;log_e_0&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">))</span>
        <span class="n">log_r_c</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;log_r_c&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">))</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">))</span>

        <span class="n">e_0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">log_e_0</span>
        <span class="n">r_c</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">log_r_c</span>

        <span class="n">u_beta</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">gammaln</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">beta</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">gammaln</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">beta</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">u_beta</span><span class="o">*</span><span class="n">e_0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="n">r_c</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">beta</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">log_bkg</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="xsb_fluc.physics.ellipse" class="doc doc-heading">
            <code>xsb_fluc.physics.ellipse</code>


<a href="#xsb_fluc.physics.ellipse" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">

        <p>Python module containing models for the ellipticity of projected surface brightness.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="xsb_fluc.physics.ellipse.EllipseRadius" class="doc doc-heading">
            <code>EllipseRadius</code>


<a href="#xsb_fluc.physics.ellipse.EllipseRadius" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Module</code></p>



        <p>Include ellipticity in 2D radius maps</p>






              <details class="quote">
                <summary>Source code in <code>src/xsb_fluc/physics/ellipse.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">EllipseRadius</span><span class="p">(</span><span class="n">hk</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Include ellipticity in 2D radius maps</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_c</span><span class="p">,</span> <span class="n">y_c</span><span class="p">,</span> <span class="n">pixel_size</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EllipseRadius</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_c_init</span> <span class="o">=</span> <span class="n">x_c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_c_init</span> <span class="o">=</span> <span class="n">y_c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pixel_size</span> <span class="o">=</span> <span class="n">pixel_size</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_data</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="s2">&quot;Cluster&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Build the ellipticity model from a `Cluster` object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pixel_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">kpc_per_pixel</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">r_500</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x_c</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">y_c</span><span class="p">,</span> <span class="n">pixel_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_ref</span><span class="p">,</span> <span class="n">y_ref</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the elliptical radius for a given position.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (jnp.array): Elliptical radius in unit of $R_{500}$</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;angle&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;eccentricity&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
        <span class="n">x_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_c_init</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;x_c&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mf">0.</span><span class="p">)))</span>
        <span class="n">y_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_c_init</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;y_c&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mf">0.</span><span class="p">)))</span>

        <span class="n">x_tilde</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_ref</span><span class="o">-</span><span class="n">x_c</span><span class="p">)</span><span class="o">*</span><span class="n">jnp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">y_ref</span><span class="o">-</span><span class="n">y_c</span><span class="p">)</span><span class="o">*</span><span class="n">jnp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
        <span class="n">y_tilde</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_ref</span><span class="o">-</span><span class="n">y_c</span><span class="p">)</span><span class="o">*</span><span class="n">jnp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x_ref</span><span class="o">-</span><span class="n">x_c</span><span class="p">)</span><span class="o">*</span><span class="n">jnp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x_tilde</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">y_tilde</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">pixel_size</span>

        <span class="k">return</span> <span class="n">r</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="xsb_fluc.physics.ellipse.EllipseRadius.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">x_ref</span><span class="p">,</span> <span class="n">y_ref</span><span class="p">)</span></code>

<a href="#xsb_fluc.physics.ellipse.EllipseRadius.__call__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Compute the elliptical radius for a given position.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Elliptical radius in unit of <span class="arithmatex">\(R_{500}\)</span></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/xsb_fluc/physics/ellipse.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_ref</span><span class="p">,</span> <span class="n">y_ref</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the elliptical radius for a given position.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (jnp.array): Elliptical radius in unit of $R_{500}$</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;angle&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;eccentricity&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">x_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_c_init</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;x_c&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mf">0.</span><span class="p">)))</span>
    <span class="n">y_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_c_init</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;y_c&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mf">0.</span><span class="p">)))</span>

    <span class="n">x_tilde</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_ref</span><span class="o">-</span><span class="n">x_c</span><span class="p">)</span><span class="o">*</span><span class="n">jnp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">y_ref</span><span class="o">-</span><span class="n">y_c</span><span class="p">)</span><span class="o">*</span><span class="n">jnp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="n">y_tilde</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_ref</span><span class="o">-</span><span class="n">y_c</span><span class="p">)</span><span class="o">*</span><span class="n">jnp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x_ref</span><span class="o">-</span><span class="n">x_c</span><span class="p">)</span><span class="o">*</span><span class="n">jnp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x_tilde</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">y_tilde</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">pixel_size</span>

    <span class="k">return</span> <span class="n">r</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="xsb_fluc.physics.ellipse.EllipseRadius.from_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#xsb_fluc.physics.ellipse.EllipseRadius.from_data" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Build the ellipticity model from a <code>Cluster</code> object.</p>

            <details class="quote">
              <summary>Source code in <code>src/xsb_fluc/physics/ellipse.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_data</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="s2">&quot;Cluster&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Build the ellipticity model from a `Cluster` object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pixel_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">kpc_per_pixel</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">r_500</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pix</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x_c</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">y_c</span><span class="p">,</span> <span class="n">pixel_size</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="xsb_fluc.physics.turbulence" class="doc doc-heading">
            <code>xsb_fluc.physics.turbulence</code>


<a href="#xsb_fluc.physics.turbulence" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="xsb_fluc.physics.turbulence.KolmogorovPowerSpectrum" class="doc doc-heading">
            <code>KolmogorovPowerSpectrum</code>


<a href="#xsb_fluc.physics.turbulence.KolmogorovPowerSpectrum" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Module</code></p>



        <p>Kolmogorov power spectrum</p>
<div class="arithmatex">\[\mathcal{P}_{3D}(k)= \sigma^2 \frac{e^{-\left(k/k_{\text{inj}}\right)^2} e^{-\left(k_{\text{dis}}/k\right)^2} k^{-\alpha} }{\int 4\pi k^2  \, e^{-\left(k/k_{\text{inj}}\right)^2} e^{-\left(k_{\text{dis}}/k\right)^2} k^{-\alpha} \text{d} k}\]</div>






              <details class="quote">
                <summary>Source code in <code>src/xsb_fluc/physics/turbulence.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">KolmogorovPowerSpectrum</span><span class="p">(</span><span class="n">hk</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Kolmogorov power spectrum</span>

<span class="sd">    $$\mathcal{P}_{3D}(k)= \sigma^2 \frac{e^{-\left(k/k_{\text{inj}}\right)^2} e^{-\left(k_{\text{dis}}/k\right)^2} k^{-\alpha} }{\int 4\pi k^2  \, e^{-\left(k/k_{\text{inj}}\right)^2} e^{-\left(k_{\text{dis}}/k\right)^2} k^{-\alpha} \text{d} k}$$</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">KolmogorovPowerSpectrum</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>

        <span class="n">log_sigma</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;log_sigma&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">))</span>
        <span class="n">log_inj</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;log_inj&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">))</span>
        <span class="n">log_dis</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">hk</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">init</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mi">11</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>

        <span class="n">k_inj</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">log_inj</span><span class="p">)</span>
        <span class="n">k_dis</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">log_dis</span><span class="p">)</span>

        <span class="n">sigma</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">log_sigma</span>

        <span class="n">k_int</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">k_inj</span><span class="o">/</span><span class="mi">20</span><span class="p">,</span> <span class="n">k_dis</span><span class="o">*</span><span class="mi">20</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">k_int</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">k_inj</span> <span class="o">/</span> <span class="n">k_int</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">k_int</span><span class="o">/</span> <span class="n">k_dis</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">k_int</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">k_int</span><span class="p">))</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">k_inj</span> <span class="o">/</span> <span class="n">k</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">k</span> <span class="o">/</span> <span class="n">k_dis</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">),</span> <span class="mf">0.</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">res</span> <span class="o">/</span> <span class="n">norm</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs Insiders
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.tabs.link", "content.code.copy", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.1e90e0fb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.a59f24f2.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>